## Test scripts for the compressible ICM


These tests will compute the dynamic structure factors, $S_{uv}(k, w) = \left\langle u(k,w)v(k,w)^*\right\rangle$ of the fluid.
The script will compute many identical runs and average the following correlations:

  * $S_{\rho\rho}$
  * $S_{v_xv_x}
  * $S_{v_xv_y}
  * $S_{\rho v_x}$

The numerical results will be compared with theory taken from [1] and [2] (the actual theory data files were generated by solving the analytic results with a maple sheet).
In particular, this script will reproduce figure 5 in [3].

## Usage

Run test.bash in this folder.

## Some details

The dynamic structure factors are computed in the following way. We perform a simulation without particles and let it relax. Then, for each step until the end of the simulation:
	* Fourier transform $\rho$, $v_x$ and $v_y$ in the whole domain.
	* Store only some wave numbers (the 2,2,2 at the time of writing). i.e $\rho(k=(2,2,2),t)$, etc.
	* Once enough times are stored Fourier transform in time to get $\rho(k, w)$,etc.
	* Compute $S_{uv}$ for each simulation and average

Finally the whole process is repeated a number of times to improve statistics and estimate error.


### References:

[1]  Hydrodynamic fluctuations in fluids and fluid mixtures. de Zarate 2006.
[2]  Dynamic Light scattering. Berne and Pecora 1990.
[3]  Staggered schemes for fluctuating hydrodynamics. Balboa et.al 2012. https://doi.org/10.1137/120864520
